% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/alpha_adaptive.R
\name{compute_adaptive_alphas}
\alias{compute_adaptive_alphas}
\title{Compute Adaptive Alpha Levels by Tree Depth}
\usage{
compute_adaptive_alphas(
  k,
  delta_hat,
  N_total,
  tau = 0.1,
  max_depth = 20L,
  thealpha = 0.05
)
}
\arguments{
\item{k}{Branching factor. Either a scalar (constant k at all levels)
or an integer vector of length \code{max_depth} where \code{k[ell]}
is the branching factor at level \code{ell}.}

\item{delta_hat}{Estimated standardized effect size (e.g., Cohen's d).
Conservative (larger) values produce more stringent adjustment,
which preserves the FWER guarantee. Use an upper bound on the
true effect size.}

\item{N_total}{Total sample size at the root level.}

\item{tau}{Cumulative power threshold (default 0.1). When cumulative
power drops below \code{tau}, natural gating is deemed sufficient
and nominal alpha is used.}

\item{max_depth}{Maximum depth to compute (default 20).}

\item{thealpha}{Nominal significance level (default 0.05).}
}
\value{
Named numeric vector of adjusted alpha levels, one per depth
(1 through \code{max_depth}). Names are depth levels as characters.
}
\description{
Implements Algorithm 1 from the adaptive alpha appendix. Computes
adjusted significance levels for each tree level based on estimated
power decay through the tree.
}
\details{
The formula at level \eqn{\ell} is:
\deqn{\alpha_\ell^{adj} = \alpha / (k^{(\ell-1)} \cdot \prod_{j=1}^{\ell-1} \hat\theta_j)}
when cumulative power exceeds \code{tau}, and \eqn{\alpha_\ell^{adj} = \alpha}
otherwise.

The FWER guarantee (Theorem in Appendix D) requires that power
is not underestimated (i.e., \eqn{\hat\theta_j \geq \theta_j}).
In practice this means using a conservatively large \code{delta_hat}.
}
\examples{
# Alpha schedule for a 4-ary tree with moderate effect
compute_adaptive_alphas(k = 4, delta_hat = 0.5, N_total = 1000)

# Binary tree with very high power â€” approaches Bonferroni
compute_adaptive_alphas(k = 2, delta_hat = 0.5, N_total = 1e6,
                        tau = 0, max_depth = 5)

}
