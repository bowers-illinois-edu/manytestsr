% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/alpha_adaptive.R
\name{compute_adaptive_alphas}
\alias{compute_adaptive_alphas}
\title{Compute Adaptive Alpha Levels by Tree Depth}
\usage{
compute_adaptive_alphas(
  k,
  delta_hat,
  N_total,
  max_depth = 20L,
  thealpha = 0.05
)
}
\arguments{
\item{k}{Branching factor. Either a scalar (constant k at all levels)
or an integer vector of length \code{max_depth} where \code{k[ell]}
is the branching factor at level \code{ell}.}

\item{delta_hat}{Estimated standardized effect size (e.g., Cohen's d).
Conservative (larger) values produce more stringent adjustment,
which preserves the FWER guarantee. Use an upper bound on the
true effect size.}

\item{N_total}{Total sample size at the root level.}

\item{max_depth}{Maximum depth to compute (default 20).}

\item{thealpha}{Nominal significance level (default 0.05).}
}
\value{
Named numeric vector of adjusted alpha levels, one per depth
(1 through \code{max_depth}). Names are depth levels as characters.
Has attribute \code{"error_load"} containing the
\code{\link{compute_error_load}} result, so the caller can inspect
whether adjustment was needed.
}
\description{
Implements Algorithm 1 from Appendix B of the supplement. First checks
whether natural gating suffices (total error load \eqn{\le 1}); if so,
returns nominal alpha at every level. Otherwise, computes adjusted
significance levels that compensate for the error load at each depth.
}
\details{
The function first calls \code{\link{compute_error_load}} to assess
whether natural gating suffices. When \eqn{\sum G_\ell \le 1}, no
adjustment is needed and nominal \code{thealpha} is returned at every
level.

When adjustment is needed, the formula at level \eqn{\ell} is:
\deqn{\alpha_\ell^{adj} = \min\left\{\alpha,\;
  \frac{\alpha}{k^{(\ell-1)} \cdot \prod_{j=1}^{\ell-1} \hat\theta_j}
  \right\}}

The FWER guarantee (Theorem in the supplement) requires that power
is not underestimated (i.e., \eqn{\hat\theta_j \geq \theta_j}).
In practice this means using a conservatively large \code{delta_hat}.
}
\examples{
# Natural gating sufficient: all alphas = 0.05
compute_adaptive_alphas(k = 3, delta_hat = 0.2, N_total = 100,
                        max_depth = 4)

# Needs adjustment: alphas shrink at deeper levels
compute_adaptive_alphas(k = 4, delta_hat = 0.5, N_total = 1000,
                        max_depth = 5)

}
