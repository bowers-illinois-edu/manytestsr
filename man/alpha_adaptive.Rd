% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/alpha_adaptive.R
\name{alpha_adaptive}
\alias{alpha_adaptive}
\title{Adaptive Alpha Adjustment Based on Power Decay}
\usage{
alpha_adaptive(k, delta_hat, N_total, max_depth = 20L)
}
\arguments{
\item{k}{Branching factor. Either a scalar (constant k at all levels)
or an integer vector of length \code{max_depth} where \code{k[ell]}
is the branching factor at level \code{ell}.}

\item{delta_hat}{Estimated standardized effect size (e.g., Cohen's d).
Conservative (larger) values produce more stringent adjustment,
which preserves the FWER guarantee. Use an upper bound on the
true effect size.}

\item{N_total}{Total sample size at the root level.}

\item{max_depth}{Maximum depth to compute (default 20).}
}
\value{
A function with signature
\code{function(pval, batch, nodesize, thealpha, thew0, depth)}
conforming to the \code{alphafn} interface used by
\code{\link{find_blocks}}.
}
\description{
Factory function that creates an alpha adjustment function for use
with \code{\link{find_blocks}}. The returned function adjusts
significance levels at each tree depth based on estimated power
decay (Algorithm 1 from Appendix B of the supplement).
}
\details{
The returned function uses the \code{depth} parameter (passed by
\code{find_blocks}) to look up the pre-computed alpha for each
node's tree depth. The \code{pval}, \code{batch}, \code{nodesize},
and \code{thew0} parameters are accepted for interface compatibility
but are not used â€” unlike online FDR methods, the adaptive alpha
depends only on tree structure, not on observed p-values.

Results are cached internally: the vector of adjusted alphas is
computed once per unique value of \code{thealpha} and reused on
subsequent calls. When the error load is at most 1 (natural gating
suffices), nominal alpha is returned at every level.
}
\examples{
# Create an adaptive alpha function for a 4-ary tree
my_alpha <- alpha_adaptive(k = 4, delta_hat = 0.5, N_total = 1000)

# Use with find_blocks
# find_blocks(idat, bdat, ..., alphafn = my_alpha)

# Inspect the alpha schedule it will use
compute_adaptive_alphas(k = 4, delta_hat = 0.5, N_total = 1000)

}
