<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Adaptive Alpha with Branch Pruning — alpha_adaptive_tree_pruned • manytestsr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adaptive Alpha with Branch Pruning — alpha_adaptive_tree_pruned"><meta name="description" content="Factory function that creates an adaptive alpha adjustment system
supporting branch pruning. Unlike alpha_adaptive_tree,
which pre-computes a fixed schedule, this version can recompute the
schedule on a pruned subtree after each depth — giving more alpha
to surviving branches when dead branches are removed."><meta property="og:description" content="Factory function that creates an adaptive alpha adjustment system
supporting branch pruning. Unlike alpha_adaptive_tree,
which pre-computes a fixed schedule, this version can recompute the
schedule on a pruned subtree after each depth — giving more alpha
to surviving branches when dead branches are removed."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">manytestsr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.1002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/advanced-methodologies.html">Advanced Statistical Methodologies in manytestsr</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with manytestsr</a></li>
    <li><a class="dropdown-item" href="../articles/hierarchical-testing-workflow.html">Hierarchical Testing with manytestsr</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Adaptive Alpha with Branch Pruning</h1>

      <div class="d-none name"><code>alpha_adaptive_tree_pruned.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Factory function that creates an adaptive alpha adjustment system
supporting branch pruning. Unlike <code><a href="alpha_adaptive_tree.html">alpha_adaptive_tree</a></code>,
which pre-computes a fixed schedule, this version can recompute the
schedule on a pruned subtree after each depth — giving more alpha
to surviving branches when dead branches are removed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">alpha_adaptive_tree_pruned</span><span class="op">(</span><span class="va">node_dat</span>, <span class="va">delta_hat</span>, max_depth <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-node-dat">node_dat<a class="anchor" aria-label="anchor" href="#arg-node-dat"></a></dt>
<dd><p>A data.frame or data.table with columns
<code>nodenum</code>, <code>parent</code>, <code>depth</code>, and <code>nodesize</code>.
Typically extracted from a <code><a href="find_blocks.html">find_blocks</a></code> result.
The root node must have <code>parent = 0</code> and <code>depth = 1</code>.</p></dd>


<dt id="arg-delta-hat">delta_hat<a class="anchor" aria-label="anchor" href="#arg-delta-hat"></a></dt>
<dd><p>Estimated standardized effect size (e.g., Cohen's d).
Conservative (larger) values produce more stringent adjustment,
which preserves the FWER guarantee.</p></dd>


<dt id="arg-max-depth">max_depth<a class="anchor" aria-label="anchor" href="#arg-max-depth"></a></dt>
<dd><p>Maximum depth to compute. Defaults to the maximum
depth present in <code>node_dat</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with three components:</p><dl><dt><code>alphafn</code></dt>
<dd><p>A function with the standard alphafn
interface: <code>function(pval, batch, nodesize, thealpha,
    thew0, depth)</code>. Looks up the current alpha schedule by depth.</p></dd>

<dt><code>update</code></dt>
<dd><p>A function
<code>function(pruned_node_dat, thealpha)</code> that recomputes
the alpha schedule on the given (pruned) tree. Called by
<code>find_blocks</code> after each depth's testable decisions.</p></dd>

<dt><code>reset</code></dt>
<dd><p>A function <code>function(thealpha)</code> that
restores the alpha schedule to the full (unpruned) tree.
Called by <code>find_blocks</code> at the start of each run to
ensure independence across simulation iterations.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The FWER guarantee follows from the same telescoping-sum argument
as <code><a href="alpha_adaptive_tree.html">alpha_adaptive_tree</a></code>, applied to the surviving
subtree at each depth. Pruning decisions at depth \(d\) depend
only on tests at depths \(1, \ldots, d\), which are independent
of tests at deeper levels (under data splitting or independent
permutation tests), so the conditional FWER bound holds.</p>
<p>When <code>find_blocks</code> detects a list-valued <code>alphafn</code>,
it extracts these three components and calls <code>reset</code> at
the start of each run and <code>update</code> after each depth.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  nodenum  <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>  parent   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  depth    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nodesize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">250</span>, <span class="fl">250</span>, <span class="fl">125</span>, <span class="fl">125</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">alpha_adaptive_tree_pruned</span><span class="op">(</span>node_dat <span class="op">=</span> <span class="va">nd</span>, delta_hat <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># obj$alphafn — pass to find_blocks</span></span></span>
<span class="r-in"><span><span class="co"># obj$update(pruned_nd, 0.05) — recompute on surviving tree</span></span></span>
<span class="r-in"><span><span class="co"># obj$reset(0.05) — restore full-tree schedule</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jake Bowers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

